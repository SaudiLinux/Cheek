# Cheek - أداة فحص أمني شاملة

Cheek هو أداة فحص أمني متقدمة مصممة للكشف عن مختلف خوادم الويب، وخوادم البريد الإلكتروني، وقواعد البيانات، والتطبيقات، وأطر العمل، والثغرات الأمنية دون الحاجة إلى مصادقة.

## المميزات

### 🔍 اكتشاف خادم الويب
- **Apache HTTP Server** - الكشف عبر الرؤوس وتحليل المحتوى
- **Nginx** - اكتشاف خادم الويب والوكيل العكسي
- **Lighttpd** - تعريف خادم الويب خفيف الوزن
- **Microsoft IIS** - اكتشاف خدمات معلومات الإنترنت
- **خوادم إضافية** - عبر تحليل الرأس وبصمات الأصابع

### 📧 اكتشاف خادم البريد الإلكتروني
- **Sendmail** - اكتشاف وكيل نقل البريد
- **Postfix** - تعريف خادم SMTP
- **Exim** - اكتشاف خادم البريد
- **Dovecot** - اكتشاف خادم IMAP/POP3
- **مسح المنافذ** - لـ SMTP (25، 587)، و SMTPS (465)، و IMAP (143، 993)، و POP3 (110، 995)

### 🗄️ اكتشاف قاعدة البيانات
- **MySQL** - اكتشاف المنفذ 3306
- **PostgreSQL** - تحديد المنفذ 5432
- **Redis** - اكتشاف المنفذ 6379
- **MongoDB** - تحديد المنفذ 27017
- **Memcached** - اكتشاف المنفذ 11211

### 🚀 اكتشاف الإطار
- **Django** - إطار عمل ويب Python
- **Flask** - إطار عمل صغير للغة بايثون
- **Spring Framework** - إطار عمل Java Enterprise
- **Ruby on Rails** - إطار عمل ويب Ruby
- **Laravel** - إطار عمل PHP
- **Express.js** - إطار عمل Node.js
- **ASP.NET** - إطار عمل مايكروسوفت
- **PHP** - اكتشاف PHP الأساسي

### 🎯 اكتشاف منصة CMS
- **WordPress** - عبر wp-content ومسارات wp-includes
- **Joomla** - اكتشاف المكونات والوحدات النمطية
- **Drupal** - دليل المواقع والملفات الأساسية
- **Magento** - اكتشاف منصة التجارة الإلكترونية
- **OpenCart** - اكتشاف عربة التسوق
- **PrestaShop** - اكتشاف حلول التجارة الإلكترونية

### 🔄 اكتشاف منصة CI/CD
- **Jenkins** - اكتشاف خادم الأتمتة
- **GitLab** - تحديد منصة DevOps
- **Drone CI** - منصة التكامل المستمر
- **Travis CI** - اكتشاف أتمتة البناء
- **GoCD** - أداة التسليم المستمر
- **GitHub Actions** - أتمتة سير العمل

### 🐳 اكتشاف الحاويات والتنسيق
- **Kubernetes** - تنسيق الحاويات
- **Docker** - منصة الحاويات
- **Apache Hadoop** - إطار عمل البيانات الضخمة
- **HashiCorp Consul** - شبكة الخدمة
- **HashiCorp Nomad** - تنسيق عبء العمل

### 🔒 اكتشاف الثغرات الأمنية
- **قائمة الدليل** - تمكين تصفح الدليل
- **الكشف عن إصدار الخادم** - تسرب المعلومات
- **عناوين أمان مفقودة** - خيارات إطار X، خيارات نوع محتوى X
- **تكوين ملفات تعريف الارتباط غير الآمنة** - عدم وجود أعلام Secure/HttpOnly
- **تجاوز المصادقة** - أخطاء التكوين الشائعة
- **إظهار الروابط المخفية والملفات المخفية**

### 🌐 اكتشاف واجهات برمجة التطبيقات الحديثة
- **REST APIs** - الكشف عن واجهات REST
- **GraphQL** - اكتشاف GraphQL endpoints
- **API Documentation** - العثور على توثيق API
- **OpenAPI/Swagger** - اكتشاف مواصفات API

### ☁️ اكتشاف الخدمات السحابية
- **Amazon Web Services (AWS)** - اكتشاف خدمات AWS
- **Microsoft Azure** - تحديد خدمات Azure
- **Google Cloud Platform (GCP)** - اكتشاف خدمات GCP
- **DNS Records Analysis** - تحليل السجلات السحابية

### 🛡️ الثغرات الأمنية الحديثة
- **GraphQL Injection** - اكتشاف ثغرات GraphQL
- **API Misconfiguration** - سوء إعدادات API
- **JWT Vulnerabilities** - ثغرات رموز JWT
- **Server-Side Request Forgery (SSRF)** - اكتشاف SSRF
- **Insecure Deserialization** - التحليل غير الآمن
- **Broken Authentication** - مشاكل المصادقة
- **CORS Misconfiguration** - سوء إعدادات CORS
- **Missing Rate Limiting** - غياب حدود المعدل

### 🎯 وحدات الاستغلال المتقدمة
الأداة تتضمن وحدات استغلال متخصصة:
- **Web Exploits** - استغلال ثغرات الويب الأساسية
- **Advanced Exploits** - استغلال SQL Injection والثغرات المتقدمة
- **Modern Vulnerabilities** - استغلال الثغرات الحديثة (GraphQL، JWT، SSRF)

### ☁️ قدرات الاستغلال السحابي المتقدمة
الأداة الآن تتضمن نظام استغلال سحابي شامل:
- **استغلال خدمة البيانات الوصفية** - AWS IMDSv1، Azure Instance Metadata Service
- **استغلال S3 Buckets** - اكتشاف واستغلال حاويات S3 العامة
- **استغلال Azure Blob Storage** - فحص التخزين العام في Azure
- **استغلال Kubernetes APIs** - اكتشاف واجهات Kubernetes المكشوفة
- **استغلال واجهات API السحابية** - اكتشاف واجهات برمجة التطبيقات غير المصادقة
- **فحص الحاويات السحابية** - اكتشاف ثغرات Docker وKubernetes
- **استغلال خدمات GCP** - فحص خدمات Google Cloud Platform
- **أدوات الاستغلال السحابي الموحدة** - وحدة متكاملة لجميع المميزات السحابية

## التثبيت

### المتطلبات
- Python 3.6 أو أحدث
- pip (مدير حزم Python)
- Windows/Linux/Mac OS

### حزم Python المطلوبة
- requests >= 2.28.0
- urllib3 >= 1.26.0
- colorama >= 0.4.4
- dnspython >= 2.0.0
- python-nmap >= 0.7.1
- beautifulsoup4 >= 4.11.0
- lxml >= 4.9.0
- selenium >= 4.0.0
- xmltodict >= 0.13.0
- configparser >= 5.3.0
- boto3 >= 1.26.0 (لاستغلال AWS)
- azure-storage-blob >= 12.14.0 (لاستغلال Azure)
- google-cloud-storage >= 2.7.0 (لاستغلال GCP)

### خطوات التثبيت

1. استنساخ المستودع أو تحميل الملفات:
```bash
git clone https://github.com/SayerLinux/Cheek.git
cd Cheek
```

2. تثبيت المتطلبات:
```bash
pip install -r requirements.txt
```

3. منح صلاحيات التنفيذ (لأنظمة Linux/Mac):
```bash
chmod +x cheek.py
```

## الاستخدام

### الفحص الأساسي
```bash
python cheek.py example.com
```

### خيارات متقدمة
```bash
# تحديد عدد مؤشرات الترابط
python cheek.py example.com -t 20

# تحديد مهلة الاتصال
python cheek.py example.com --timeout 10

# فحص منافذ محددة
python cheek.py example.com --ports 80 443 3306 5432

# حفظ التقرير في ملف محدد
python cheek.py example.com --output my_report.json

# فحص الاستغلال السحابي فقط
python cheek.py example.com --cloud-exploit

# فحص الثغرات السحابية فقط
python cheek.py example.com --cloud-vulns

# تشغيل جميع فحوصات السحابة
python cheek.py example.com --cloud-tests

# استخدام الفاحص السحابي الموحد
python unified_cloud_scanner.py example.com -v
```
# فحص سريع
./cloud_security_scanner.sh target.com quick

# فحص شامل  
./cloud_security_scanner.sh target.com full --threads 20

# فحص تجريبي
./cloud_security_scanner.sh target.com demo


### تقارير JSON المحسنة
الأداة الآن تنتج تقارير JSON متقدمة تحتوي على:
- **بيانات التعريف بالفحص** - وقت الفحص، الإصدار، المدة
- **ملخص الفحص** - عدد الخدمات، الثغرات، التطبيقات المكتشفة
- **معلومات DNS** - سجلات A، MX، TXT، NS
- **خدمات الشبكة** - المنافذ المفتوحة، الخوادم المكتشفة
- **التقنيات المستخدمة** - الأطر، أنظمة إدارة المحتوى، منصات CI/CD
- **واجهات API** - REST APIs، GraphQL، التوثيق
- **الخدمات السحابية** - AWS، Azure، GCP
- **التقييم الأمني** - الثغرات الشائعة والحديثة
- **تقييم المخاطر** - مستوى المخاطر الإجمالي مع التصنيف

يتم إنشاء ملفين JSON:
- **تقرير كامل** - يحتوي على جميع البيانات التفصيلية
- **تقرير ملخص** - يحتوي على أهم النتائج والثغرات الحرجة

### تقارير الاستغلال السحابي
عند استخدام خيارات السحابة، تتضمن التقارير:
- **نتائج استغلال الخدمات السحابية** - S3، Azure Blob، Kubernetes APIs
- **مسارات الاستغلال** - خطوات استغلال كل ثغرة
- **توصيات الإصلاح** - خطوات تأمين كل خدمة سحابية
- **تصنيف المخاطر السحابية** - مستويات الخطورة لكل ثغرة سحابية
```

### الخيارات المتاحة
- `-t, --threads`: عدد مؤشرات الترابط (افتراضي: 10)
- `--timeout`: مهلة الاتصال بالثواني (افتراضي: 5)
- `--ports`: المنافذ المحددة للفحص (افتراضي: منافذ شائعة)
- `--output`: ملف الإخراج للتقرير

### أمثلة الاستخدام
```bash
# فحص شامل مع تقرير JSON
python cheek.py target.com --output report.json

# فحص سريع مع عدد مؤشرات ترابط محدود
python cheek.py target.com --threads 5

# فحص مع حفظ التقارير الكاملة والملخصة
python cheek.py target.com --output full_scan.json
```

### أفضل الممارسات
1. **الحصول على إذن قبل الفحص** - تأكد من أن لديك تصريحًا قانونيًا
2. **استخدام خيارات الترابط المناسبة** - ابدأ بقيمة منخفضة لتجنب الحظر
3. **مراجعة التقارير بعناية** - تحقق من النتائج وتأكد من صحتها
4. **تحديث الأداة بانتظام** - احصل على آخر التحديثات والإصلاحات

## مثال على النتائج

```
 ██████╗██╗  ██╗███████╗███████╗███████╗
██╔════╝██║  ██║██╔════╝██╔════╝██╔════╝
██║     ███████║█████╗  █████╗  █████╗  
██║     ██╔══██║██╔══╝  ██╔══╝  ██╔══╝  
╚██████╗██║  ██║███████╗███████╗███████╗
 ╚═════╝╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝

    أداة فحص أمني شاملة
    Comprehensive Security Scanner
    
المبرمج: SayerLinux
الإيميل: SaudiSayer@gmail.com

[*] بدء مسح المنافذ...
[+] المنفذ 80 مفتوح
[+] المنفذ 443 مفتوح
[+] المنفذ 3306 مفتوح

[*] الكشف عن خوادم الويب...
[+] خادم ويب (HTTP): Apache HTTP Server 2.4.41 على المنفذ 80
[+] خادم ويب (HTTPS): Nginx 1.18.0 على المنفذ 443

[*] الكشف عن قواعد البيانات...
[+] قاعدة بيانات: MySQL Database على المنفذ 3306

[*] الكشف عن الأطر وتقنيات الويب...
[+] إطار عمل: PHP 7.4.3
[+] إطار عمل: Laravel

[*] الكشف عن أنظمة إدارة المحتوى...
[+] CMS: WordPress (العثور على: /wp-content/)

[*] الكشف عن واجهات برمجة التطبيقات الحديثة...
[+] REST API: /api/v1/users (200 OK)
[+] GraphQL: /graphql (200 OK)
[+] توثيق API: /api/docs (HTML)

[*] الكشف عن الخدمات السحابية...
[+] AWS S3: s3.amazonaws.com (DNS)
[+] AWS CloudFront: d123456.cloudfront.net (Headers)

[*] الكشف عن الثغرات الأمنية الحديثة...
[CRITICAL] GraphQL Introspection Enabled
[HIGH] CORS Misconfiguration
[HIGH] JWT Weak Algorithm
[MEDIUM] Missing Rate Limiting
[MEDIUM] API Excessive Methods

[*] الكشف عن الثغرات الأمنية التقليدية...
[!] تحذير: رأس الأمان X-Frame-Options مفقود
[!] تحذير: رأس الأمان X-Content-Type-Options مفقود
[!] تحذير: الكشف عن إصدار الخادم

[+] تقييم المخاطر: HIGH RISK (8 ثغرات حرجة/عالية)

[+] تم حفظ التقارير إلى:
    - example.com_report.json (تقرير كامل)
    - example.com_summary.json (تقرير ملخص)
    - cloud_exploitation_report.json (تقرير استغلال سحابي)
    - unified_cloud_scan_*.json (تقرير فحص سحابي موحد)
```

## المبرمج
- **الاسم**: SayerLinux
- **الإيميل**: SaudiSayer@gmail.com

## الترخيص
هذا المشروع مفتوح المصدر ومتاح للاستخدام الشخصي والتعليمي.

## التنبيهات القانونية
**⚠️ استخدم هذه الأداة فقط على الأنظمة التي تملك صلاحية اختبارها. يُمنع استخدام هذه الأداة لأي أنشطة غير قانونية أو غير مصرح بها.**

## المساهمة
يسعدنا استقبال المساهمات والاقتراحات. يمكنك التواصل عبر:
- الإيميل: SaudiSayer@gmail.com
- المشكلات (Issues) في المستودع

## الشكر والتقدير
شكر خاص لجميع المساهمين في مجال الأمن السيبراني ومشاريع مفتوحة المصدر.
